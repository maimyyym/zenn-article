---
title: "【感想メモ】一人で小さく始めるAWS複数アカウント管理で感じたこと"
emoji: "👗"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["aws"]
published: true
publication_name: "fusic"
---

## きっかけ
2024年1月30日に開催されていた、JAWS-UG東京の「AWS個人検証アカウントどう運用してる？ランチ共有会」を見て、やってみよう！ということでやってみました🙌
https://jawsug.connpass.com/event/308155/

## この記事について
### 話すこと
複数アカウント運用を設定して感じたこと

### 話さないこと
AWS OrganizationsやAWS Identity Centerの詳しい内容・設定方法

## やりたいこと
個人サイト等の運用のためのアカウント、検証用のアカウント…複数アカウントに分けて管理したい。
**【理由】** 個人用だからと適当運用してリソースが散らかりがち。頭の中も散らかりがち。

## やること
### Organizationsを有効化
- うれしいこと
    コスト管理が楽になる
    アカウントの把握が楽になる

### IAM Identity CenterでSSOログインできるようにする
- うれしいこと
    IAM Identity Centerが提供するAWSアクセスポータルに一度ログインするだけで複数アカウントへのアクセスが簡単にできる

## AWS Organizations
>AWS Organizations は、ユーザーが作成して一元管理する組織に、複数の AWS アカウント を統合するためのアカウント管理サービスです。AWS Organizations には、お客様のビジネスの予算、セキュリティ、コンプライアンスのニーズをより適切に満たすアカウント管理および一括請求 (コンソリデーティッドビリング) 機能が備わっています。組織の管理者は、組織内にアカウントを作成したり、既存のアカウントを組織に招待して参加させることができます。
>[AWS Organizations の概要](https://docs.aws.amazon.com/ja_jp/organizations/latest/userguide/orgs_introduction.html)

AWS Organizationsはアカウントの一括管理、コストの一括請求が可能です。
組織での利用のためのサービスですが、個人で使ってみてメリットは大きかったです。
- 課題
    一人で様々なサービスを検証利用してみたり小さなアプリケーションをデプロイしていると、何がどこにあってどんな使用状況で…？と整理できなくなりました。
    何より自分の頭の中がごちゃごちゃしてきて、スマートではなくなっていました。
- 使ってみて
    Organizationsを有効化して用途に応じて複数アカウント管理を可視化させることで脳への負荷を減らすことができました。
    そしてコストを一括請求できることは個人利用にも最適です。

:::message
複数アカウント作成時にメールアドレスはどうする？問題がありますが、上記の勉強会を見ている時にGmailのエイリアスを使用するという方法を知りました。
メールアドレスの登録およびメールの受信のみであれば、使用中のメールアドレスの`@`の前に`+{任意の文字列}`をつけるだけで利用可能です。（送信は別途設定が必要）
例：`XXX+hogehoge@gmail.com`
:::

こんな感じ。
![](/images/20240328_aws_sso_1.png)

## AWS IAM Identity Center
>AWS IAM Identity Center は、すべての AWS アカウント とクラウドアプリケーションのためのシングルサインオンサービスを提供します。AWS Directory Service を通じて Microsoft Active Directory に接続され、そのディレクトリのユーザーは、既存の Active Directory のユーザー名とパスワードを使用して、パーソナライズされた AWS ポータルにサインインできるようになります。AWS アクセスポータルから、ユーザーは、権限を持つすべての AWS アカウント およびクラウド アプリケーションにアクセスできます。
>[AWS IAM Identity Center および AWS Organizations](https://docs.aws.amazon.com/ja_jp/organizations/latest/userguide/services-that-can-integrate-sso.html)

IAM Identity Centerは複数アカウントへのアクセスを一括で管理できるAWSアクセスポータルを提供しています。
個人的にはアクセスポータルがとても便利で、複数アカウント運用で考えられる最大のデメリットであるログイン管理・切り替えの問題がここでほぼ解消されます。一度ログインするだけで複数アカウントにアクセスができるSSO、リソースをさくっと確認したい…という時などとても便利！

IAM Identity Centerの設定後はコンソールのこちらにあるアクセスポータルURLから利用します。
![](/images/20240328_aws_sso_2.png)
:::message
【私が勘違いしていたこと】
IAM Identity Centerをセットアップした後、各アカウントごとにログイン用URLがあると思っていました。よくよく考えれば、それでは意味がない…！なんですが、一つのアクセスポータルで複数アカウントへのアクセスを管理できる便利さをより実感しました。
:::

この画面はまだ一アカウントのみですが、ログイン後。ここに設定済みのアカウントが全て表示・それぞれアクセス可能です。
![](/images/20240328_aws_sso_3.png)

## まとめ
### OrganizationsとIdentity Centerをセットアップしてみて
個人利用なので一つのアカウントでの運用がシンプル…に思えますが、複数の用途があったりリソースを使い捨てするような検証利用だったりが発生するからこそ複数アカウント運用はとても便利だと感じました。
私の場合は、この運用の方がむしろ頭の中もスッキリ！でいい感じです。些細なことでも脳への負荷を大幅に軽くすることができたなと思います。

### これからやりたいこと
複数アカウント運用が便利とはいえ、むやみに増やしすぎず必要に応じてその都度作成しようと思っています。
そしてせっかくなので組織利用・複数環境利用の検証やまたCLIでの利用もより積極的に行いたいです。
